<% layouts.forEach(function(layout) { %>
import <%= layout.layoutName %> from './layouts/<%= layout.layoutName %>'
<% }) %>
import { firstCharToUpperCase, getRouterPath } from './helper'

window.$__wis_layouts__ = [
  <% layouts.forEach(function(layout) { %>
    '<%= layout.rawLayoutName %>',
  <% }) %>
]

const LayoutComponents = {
  <% layouts.forEach(function(layout) { %>
  <%= layout.layoutName %>: <%= layout.layoutName %>,
  <% }) %>
}

function getLayoutComponent(layoutName = '') {
  const LayoutComponent = LayoutComponents[`L${firstCharToUpperCase(layoutName)}`] || LayoutComponents.LIndex
  return LayoutComponent
}

export function getLayout() {
  const routerPath = getRouterPath()
  const [layoutName = ''] = routerPath.split('/').filter(Boolean)

  if (LayoutComponents[`L${firstCharToUpperCase(layoutName)}`]) {
    return layoutName
  }
}

export default function Layout({ children }) {
  const layoutName = getLayout()

  const LayoutComponent = getLayoutComponent(layoutName)

  if (LayoutComponent) {
    return <LayoutComponent>{children}</LayoutComponent>
  }

  return children
}
