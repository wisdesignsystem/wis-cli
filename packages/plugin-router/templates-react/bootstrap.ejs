import ReactDOM from 'react-dom/client'

import Root from './Root.jsx'

import { render as customRender } from './app.js'
import { isFunction } from './helper.js'

function render(Node) {
  const rootElement = document.getElementById(process.env.ROOT_ELEMENT_ID || 'root')

  if (!rootElement.hasAttribute('data-root')) {
    rootElement.setAttribute('data-root', '')
  }

  const root = ReactDOM.createRoot(rootElement);
  root.render(Node);
}

if (isFunction(customRender)) {
  customRender((Container) => {
    if (isFunction(Container)) {
      return render(Container(<Root />))
    }

    return render(<Root />)
  })
} else {
  render(<Root />)
}
